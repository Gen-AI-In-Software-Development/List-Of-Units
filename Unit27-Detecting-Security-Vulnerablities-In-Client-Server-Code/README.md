#  Unit27-Detecting-Security-Vulnerablities-In-Client-Server-Code

## Introduction

In this unit, we will ask Copilot to examine code for security vulnerabilities.
These examples use Microsoft Copilot provided here: [Microsoft Copilot](https://copilot.microsoft.com/).

## Use Case

Secure coding practices are essential to developing code that is resistant to attack.
In this unit, we provide simple source code examples to Copilot and ask it to evaluate the code's security.

The source code examples provided to Copilot have well known vulnerabilities.

## Prompts and Code Critique

We will show each prompt that includes source code and show Copilot's response.  We will follow each example with a short critique and rating. The ratings will be Poor, Fair, or Good.

### Example 27.1 prompt: I am concerned about security vulnerabilities in my code. Please check the following C program:

```
#include <stdio.h>
#include <string.h>

int checkUser(char user[]) {

    if(strcmp(user,"HeadOfUnit")== 0) {
       return 1;
    }
    else return 0;
}
void onlyThoseAllowed() {
    printf("%s","\nAuthenticated  user");

}

int main() {

   char user[12];
   int accessAllowed = 0;

   printf("%s", "Enter your title");

   gets(user);

   if(checkUser(user) == 1) {
       accessAllowed = 1;
   }
   if(accessAllowed != 0) {
       onlyThoseAllowed();
   }

   printf("%s","\nExecution complete");
   return 0;
}
```

### Generated Response:

```
Your code has a few security vulnerabilities that need to be addressed:

Buffer Overflow: The gets() function is unsafe because it does not check the length of the input, which can lead to buffer overflow. This can be exploited to execute arbitrary code. Use fgets() instead.

fgets(user, sizeof(user), stdin);
user[strcspn(user, "\n")] = 0; // Remove newline character if present

Hardcoded Credentials: The username “HeadOfUnit” is hardcoded, which is not secure.
Consider using a more secure method for authentication, such as hashing and
comparing passwords.
Lack of Input Validation: Ensure that the input is properly validated to
prevent injection attacks.
Here’s a revised version of your code with these improvements:

```

New code generated by Copilot:

```
#include <stdio.h>
#include <string.h>

int checkUser(const char user[]) {
    if (strcmp(user, "HeadOfUnit") == 0) {
        return 1;
    } else {
        return 0;
    }
}

void onlyThoseAllowed() {
    printf("\nAuthenticated user");
}

int main() {
    char user[12];
    int accessAllowed = 0;

    printf("Enter your title: ");
    if (fgets(user, sizeof(user), stdin)) {
        user[strcspn(user, "\n")] = 0; // Remove newline character if present
    }

    if (checkUser(user) == 1) {
        accessAllowed = 1;
    }

    if (accessAllowed != 0) {
        onlyThoseAllowed();
    }

    printf("\nExecution complete");
    return 0;
}
```



### Critique: The complaints from Copilot are correct and its proposed solution, ignoring the complaint about hardcoding credentials, is also fine. Using the fgets() function rather than gets() will ensure that the correct number of characters are read from the keyboard. Note that a modern compiler will also warn the developer that this code is insecure. But Copilot goes a step further. It sees that this program is attempting to authenticate a user and provides suggestions on how to improve the authentication code. It is working at a higher level than a compiler. Rating: Good.


## Exercises

1. Search the web for an example of an SQL injection attack. Give it to Copilot and ask it to evaluate the code for security vulnerabilities . How did it do? Poor, Fair, or Good?

2. Search the web for an example of a Cross Site Scripting attack. Give it to Copilot and ask it to evaluate the code for security vulnerabilities . How did it do? Poor, Fair, or Good?

3. Search the web for an example of an Insecure Deserialization attack. Give it to Copilot and ask it to evaluate the code for security vulnerabilities . How did it do? Poor, Fair, or Good?

# References
[1] [Cyber Security and Infrastructure Security Agency](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)

[2] [Open Worldwide Application Security Project](https://owasp.org/www-project-vulnerable-web-applications-directory/)
